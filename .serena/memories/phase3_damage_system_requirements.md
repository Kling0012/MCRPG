# Phase3: ダメージシステム実装要件

## 目的
全ダメージイベントをキャッチし、ステータスに応じたダメージ計算を行う。

## 実装内容

### 1. ダメージイベント処理
**DamageManager.java**: ダメージ管理
- 全EntityDamageEvent監視（HIGH優先度）
- プレイヤー→エンティティダメージ計算
- エンティティ→プレイヤーダメージ計算
- イベントキャンセル制御

### 2. ダメージ計算システム
**計算式**:
```
物理ダメージ = 基本ダメージ × (1 + STR/100) × クラス倍率 × クリティカル
魔法ダメージ = 基本ダメージ × (1 + INT/100) × クラス倍率
防御カット = ダメージ × (1 - VIT/(VIT+100))
最終ダメージ = 計算後ダメージ - 防御カット
```

**DamageModifier.java**: ダメージ修正
- 属性ボーナス/ペナルティ
- クラス補正
- スキル補正
- 装備補正（将来的）

### 3. クリティカルシステム
**クリティカル計算**:
```
クリティカル率 = 基礎率(5%) + DEX/50
クリティカル倍率 = 1.5 + DEX/200
```

**表示**:
- クリティカルヒット時のエフェクト
- ダメージ数値の色変化

### 4. 防御力システム
**VIT依存防御**:
```
物理防御 = VIT × 0.5
魔法防御 = SPI × 0.5
ダメージカット率 = 防御力 / (防御力 + 100)
```

### 5. ダメージ表示
**アクションバー表示**:
```
↗ 150 (45.2) [クリティカル!]
```

**コンソールログ**（デバッグ用）:
```
[Damage] Player->Zombie: Base=100, STR=50, Final=150
```

## 成果物
- ステータスに応じたダメージ変動
- プレイヤーへのダメージカット（VIT依存）
- ダメージ数値の可視化

## 技術要件
- EventPriority.HIGH
- スレッドセーフ
- 設計パターン: ストラテジー

## ファイル構成
```
damage/
├── DamageManager.java
├── DamageModifier.java
└── handlers/
    ├── PlayerDamageHandler.java
    └── EntityDamageHandler.java
```

## 優先度: 高
## 見積時間: 1週間
